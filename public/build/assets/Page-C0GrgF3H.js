import{a as V,V as k,r as F,j as e,h as R}from"./app-DzVPnBm_.js";import{A as $}from"./AuthenticatedLayout-CM951Vbx.js";import"./TextInput-BMqz3Mf8.js";import{I as H}from"./InputLabel-CVOs2is0.js";import{I as i}from"./InputError-W5ybVOTN.js";import"./ApplicationLogo-1LC3dhoW.js";const B=({initialData:a={},promotion:l,products:g,colors:v,heel_heights:N,categories:f,product_variants:L,promotion_conditions:c})=>{var p,m,b,j;const{data:o,setData:d,post:C,processing:u,errors:n,reset:w}=V({...a,conditions:((p=a.conditions)==null?void 0:p.length)>0?a.conditions:[{type:"",id:""}],discount_type:"percentage",discount_value:"0",promotion_id:l.data.id}),{flash:h}=k().props,_=[{value:"product",label:"Product"},{value:"color",label:"Color"},{value:"heel_height",label:"Heel Height"},{value:"category",label:"Category"},{value:"variant",label:"SKU / Variant"}],S=r=>{switch(r){case"product":return g.map(s=>({id:s.id,label:s.product_name}));case"color":return v.map(s=>({id:s.id,label:s.color_name}));case"heel_height":return N.map(s=>({id:s.id,label:s.value}));case"category":return f.map(s=>({id:s.id,label:s.category_name}));default:return[]}},x=(r,s,t)=>{const y=[...o.conditions];y[r][s]=t,d("conditions",y)},A=()=>{d("conditions",[...o.conditions,{type:"",id:""}])},P=r=>{d("conditions",o.conditions.filter((s,t)=>t!==r))},E=r=>{r.preventDefault(),console.log(o),C("/promotion_conditions",{onSuccess:()=>{},onFinish:()=>{w()}})},I=r=>{confirm("Are you sure you want to delete this Condition?")&&R.delete(`/promotion_conditions/${r}`)};return F.useEffect(()=>{console.log(l),console.log(c)},[l]),e.jsx($,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Create Promotion"}),children:e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[h.success&&e.jsx("div",{className:"bg-green-500 text-white px-4 py-2 rounded-md mb-4",children:h.success}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-2 font-semibold",children:["Promotion Conditions for -"," ",e.jsx("u",{children:(b=(m=l==null?void 0:l.data)==null?void 0:m.warehouse)==null?void 0:b.name})]}),e.jsxs("table",{className:"w-full table-auto border-collapse rounded-xl border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Condition Type"}),e.jsx("th",{children:"Conditional Value"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:o.conditions.map((r,s)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[e.jsxs("select",{value:r.type,onChange:t=>x(s,"type",t.target.value),className:"w-full rounded border border-slate-500/50 px-2 py-1",children:[e.jsx("option",{value:"",children:"-- Select Type --"}),_.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsx(i,{message:n[`conditions.${s}.type`]})]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.type&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:r.id,onChange:t=>x(s,"id",t.target.value),className:"w-full rounded border border-slate-500/50 px-2 py-1",children:[e.jsxs("option",{value:"",children:["-- Select"," ",r.type," ","--"]}),S(r.type).map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]}),e.jsx(i,{message:n[`conditions.${s}.id`]})]})}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsx("button",{type:"button",onClick:()=>P(s),className:"rounded-xl border border-red-500 p-2 px-2 text-red-600",children:"Remove"})})]},s))})]}),e.jsx(i,{message:n.conditions}),e.jsxs("div",{className:"mt-4 grid w-full grid-cols-2 gap-2 justify-center items-center",children:[e.jsx("div",{className:"w-full",children:e.jsx("button",{type:"submit",disabled:u,className:"w-full rounded bg-green-600 px-4 py-2 text-white",children:u?"Savingâ€¦":"Save Promotion"})}),e.jsx("button",{type:"button",onClick:A,className:"text-blue-600 border px-4 py-2 rounded border-blue-600 hover:underline",children:"+ Add Condition"})]})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(H,{value:"Conditions"}),e.jsxs("table",{className:"w-full table-auto border-collapse rounded-xl border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Condition"}),e.jsx("th",{className:"px-4 py-2",children:"Value"}),e.jsx("th",{className:"px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:(j=c.data)==null?void 0:j.map((r,s)=>{var t;return e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.conditional_type}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:(t=r.conditional_value)==null?void 0:t.name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsx("button",{type:"button",onClick:()=>I(r.id),className:"text-red-600 hover:underline",children:"Remove"})})]},s)})})]})]})]})})})})})};export{B as default};
