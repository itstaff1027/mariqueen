import{r as c,j as e,U as D,h as $}from"./app-f0nE6TeN.js";import{A as V}from"./AuthenticatedLayout-DVY7Bfvv.js";import"./ApplicationLogo-XGu9A9TJ.js";const q=({onClose:d,order:t})=>{const[N,u]=c.useState(""),g=c.useRef(null);c.useEffect(()=>{fetch("/storage/assets/jojoBragaisWW.png").then(r=>{if(!r.ok)throw new Error("Network response was not ok");return r.blob()}).then(r=>{const n=new FileReader;n.onloadend=()=>{u(n.result)},n.readAsDataURL(r)}).catch(r=>console.error("Error loading image:",r))},[]);const b=()=>{const{jsPDF:r}=window.jspdf,n=new r({orientation:"portrait",unit:"pt",format:"a4"}),m=10,w=n.internal.pageSize.getWidth(),j=g.current,v=j.offsetWidth,_=(w-m*2)/v;n.html(j,{x:m,y:m,html2canvas:{useCORS:!0,scale:_},callback:y=>{y.save(`SalesOrder_${t.order_number}.pdf`)}})};return e.jsx("div",{className:"w-full",style:{position:"fixed",inset:0,alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0,0,0,0.5)",zIndex:50,overflowY:"auto"},children:e.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",margin:"20px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{onClick:d,style:{color:"red",fontSize:"14px",border:"none",background:"none"},children:"Close"})}),e.jsx("div",{ref:g,style:{padding:"20px",color:"#000",fontSize:"12pt",backgroundColor:"#fff"},children:e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"flex w-full flex-col items-center justify-center p-10",children:[e.jsxs("div",{className:"grid w-full grid-cols-2 border-b-2",children:[e.jsx("h1",{className:"w-full text-left text-3xl font-bold"}),e.jsxs("h1",{className:"w-full text-right text-3xl font-bold",children:["Status: ",t.status.toUpperCase()]})]}),e.jsxs("div",{className:"grid grid-cols-2 w-full",children:[e.jsxs("h1",{className:"text-2xl font-bold w-full text-left",children:["Courier: ",e.jsx("u",{children:t.courier.name.toUpperCase()})]}),e.jsxs("h1",{className:"text-2xl font-bold w-full text-right",children:["Packaging Type:"," ",e.jsx("u",{children:t.packaging_type.packaging_name.toUpperCase()})]})]}),e.jsx("div",{className:"grid grid-cols-2 w-full",children:e.jsxs("h1",{className:"text-2xl font-bold w-full text-left",children:["Shoulder By: ",e.jsx("u",{children:t.shoulder_by.toUpperCase()})]})}),e.jsxs("div",{className:"my-4 w-full",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Order Items"}),e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"SKU"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Total Price"})]})}),e.jsx("tbody",{children:t.items&&t.items.length>0?t.items.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:r.product_variant.sku}),e.jsx("td",{className:"border px-4 py-2 text-right",children:r.quantity}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",parseFloat(r.unit_price).toFixed(2)]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",parseFloat(r.total_price).toFixed(2)]})]},r.id)):e.jsx("tr",{children:e.jsx("td",{className:"border px-4 py-2 text-center",colSpan:"5",children:"No items found"})})})]})]}),e.jsxs("div",{className:"flex w-full flex-col items-end justify-end border-t pt-4",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Order Summary"}),e.jsxs("p",{className:"text-gray-700",children:["Subtotal: P ",parseFloat(t.total_amount).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["VATables: P",parseFloat(t.total_amount/1.12).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["VAT: P",parseFloat(t.total_amount/1.12*.12).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["Shipping Cost: P ",parseFloat(t.shipping_cost).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["Rush Order Fee: P",parseFloat(t.rush_order_fee).toFixed(2)]}),e.jsxs("p",{className:"font-bold text-2xl text-gray-700",children:["Grand Total: P ",parseFloat(t.grand_amount).toFixed(2)]})]}),e.jsx("div",{className:"w-full mb-4",children:e.jsxs("p",{className:"text-l font-bold w-full",children:["Packaging Type Description:"," ",e.jsx("u",{children:t.packaging_type.description})]})}),e.jsxs("div",{className:"mb-4 w-full",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Payment Information"}),e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"Payment Method"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Amount Paid"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Change Due"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Excess"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Balance"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Date"})]})}),e.jsx("tbody",{children:t.payments&&t.payments.length>0?t.payments.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:r.payment_method.name}),e.jsxs("td",{className:"border px-4 py-2",children:["P ",r.amount_paid]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",r.change_due]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",r.excess_amount]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",r.remaining_balance]}),e.jsx("td",{className:"border px-4 py-2 text-right"})]},r.id)):e.jsx("tr",{children:e.jsx("td",{className:"border px-4 py-2 text-center",colSpan:"5",children:"No items found"})})})]})]}),e.jsxs("div",{className:"w-full p-4",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Customer Information"}),t.customers?e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-700",children:[t.customers.first_name," ",t.customers.last_name]}),e.jsxs("p",{className:"text-gray-700",children:["Email: ",t.customers.email]}),e.jsxs("p",{className:"text-gray-700",children:["Phone: ",t.customers.phone]}),e.jsxs("p",{className:"text-gray-700",children:["Address: ",t.customers.address]}),t.customers.receiver_name&&e.jsxs("p",{className:"text-gray-700",children:["Receiver: ",t.customers.receiver_name]})]}):e.jsx("p",{className:"text-gray-700",children:"No customer information available."})]}),e.jsxs("div",{className:"w-full border-t pt-4",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Remarks/Note:"}),e.jsx("div",{className:"h-40 w-full rounded-xl border p-4",children:t.remarks})]})]})})}),e.jsx("div",{style:{marginTop:"16px",textAlign:"center"},children:e.jsx("button",{onClick:b,style:{backgroundColor:"#000",color:"#fff",padding:"10px 20px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"14px"},children:"Download PDF"})})]})})},Y=({sales_orders:d})=>{var y;const[t,N]=c.useState(null),[u,g]=c.useState(""),[b,r]=c.useState(""),[n,m]=c.useState(""),w=()=>{$.visit("/point_of_sales",{method:"get",data:{search:u,fromDate:b,toDate:n},preserveState:!0,preserveScroll:!0})},j=s=>{N(s)},v=()=>{N(null)};c.useEffect(()=>{},[]);const _=()=>{const s=["Order Number","Client Name","Agent Name","Sold From","Tracking Number","Courier","Shoulder By","Packaging Type","Shipping Cost","Rush Cost","Total Cost","Client Payment","Status","Created At","Updated At","Payment ID","Payment Amount","Excess Amount","Remaining Balance","Payment Status","Payment Method","Payment Created At","Item ID","Quantity","Unit Price","Total Price","Discount Amount","Product SKU","Product Name","Color","Size","Heel Height"];let i=[s];const S=15;let f=[],k=1;d.data.forEach(a=>{var R,A,E,O,U,I,L,M,z,B,X,W;const C=[a.order_number,a.customers.first_name+" "+a.customers.last_name,a.user.name,a.warehouse.name,a.tracking_number,((R=a.courier)==null?void 0:R.name)||"",a.shoulder_by,((A=a.packaging_type)==null?void 0:A.packaging_name)||"",a.shipping_cost,a.rush_order_fee,a.total_amount,a.grand_amount,a.status,a.created_at,a.updated_at],h=a.payments?a.payments.length:0,F=a.items?a.items.length:0,o=Math.max(1,h,F);for(let x=0;x<o;x++){const p=[...C];if(a.payments&&a.payments[x]){let l=a.payments[x];p.push(l.id,l.amount_paid,l.excess_amount,l.remaining_balance,l.status,((E=l.payment_method)==null?void 0:E.name)||"",l.created_at)}else p.push("","","","","","","");if(a.items&&a.items[x]){let l=a.items[x];p.push(l.id,l.quantity,l.unit_price,l.total_price,l.discount_amount,((O=l.product_variant)==null?void 0:O.sku)||"",((I=(U=l.product_variant)==null?void 0:U.product)==null?void 0:I.product_name)||"",((M=(L=l.product_variant)==null?void 0:L.colors)==null?void 0:M.color_name)||"",((B=(z=l.product_variant)==null?void 0:z.size_values)==null?void 0:B.size_values)||"",((W=(X=l.product_variant)==null?void 0:X.heel_heights)==null?void 0:W.value)||"")}else p.push("","","","","","","","","","");if(o>1)for(let l=0;l<S;l++)f.push({s:{r:k,c:l},e:{r:k+o-1,c:l}});k+=o,i.push(p)}});const P=XLSX.utils.aoa_to_sheet(i),H=s.map((a,C)=>{let h=a?a.toString().length:10;return i.forEach(F=>{const o=F[C];o&&(h=Math.max(h,o.toString().length))}),{wch:h+2}});P["!cols"]=H,P["!merges"]=f;const T=XLSX.utils.book_new();XLSX.utils.book_append_sheet(T,P,"Sales Transactions"),XLSX.writeFile(T,`Sales_Orders_${new Date().toISOString().split("T")[0]}.xlsx`)};return e.jsxs(V,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Sales Orders"}),children:[e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-md rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md space-y-6 w-full mb-2",children:[e.jsxs("div",{className:"flex flex-col w-full justify-between md:flex-row md:justify-betweem md:items-center gap-4",children:[e.jsx("h1",{className:"text-3xl w-full font-semibold",children:"Point of Sales"}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end w-full",children:[e.jsx(D,{href:"/point_of_sales/create",className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Create Order"}),e.jsx("button",{onClick:_,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition",children:"Export"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"From Date:"}),e.jsx("input",{type:"date",value:b,onChange:s=>r(s.target.value),className:"border w-full rounded p-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"To Date:"}),e.jsx("input",{type:"date",value:n,onChange:s=>m(s.target.value),className:"border w-full rounded p-2"})]}),e.jsx("button",{onClick:w,className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Filter"})]}),e.jsx("div",{className:"w-full relative m-0",children:e.jsx("input",{type:"text",placeholder:"Search for Order Number, Customer Name, Tracking #",className:"w-full absolute -translate-y-1/2 text-gray-400",value:u,onChange:s=>g(s.target.value)})})]}),e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"#"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Order #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Client Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Tracking #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Status"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Payment"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Balance"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:(y=d.data)==null?void 0:y.map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:i+1}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.order_number}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[s.customers.first_name," ",s.customers.last_name]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.tracking_number?s.tracking_number:"No Tracking # added yet."}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.status}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.grand_amount}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.payments.reduce((S,f)=>S+parseFloat(f.amount_paid,2),0).toFixed(2)}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.balance}),e.jsxs("td",{className:"border border-gray-300 px-6 py-3 space-x-2",children:[e.jsx("button",{onClick:()=>j(s),className:"p-2 rounded-xl text-red-500 hover:underline",children:"Print"}),e.jsx(D,{href:`/point_of_sales/${s.id}/edit`,className:"text-blue-500 hover:underline",children:"Edit"}),e.jsx(D,{href:`/point_of_sales/${s.id}`,className:"text-emerald-500 hover:underline",children:"View"})]})]},s.id))})]}),d.links&&e.jsx("div",{className:"mt-4 flex justify-center",children:d.links.map((s,i)=>e.jsx("button",{onClick:()=>{s.url&&$.visit(s.url,{preserveState:!0,preserveScroll:!0})},className:`mx-1 px-3 py-1 border rounded ${s.active?"bg-blue-500 text-white":"bg-white text-blue-500"}`,dangerouslySetInnerHTML:{__html:s.label}},i))})]})})})})}),t&&e.jsx(q,{order:t,onClose:v})]})};export{Y as default};
