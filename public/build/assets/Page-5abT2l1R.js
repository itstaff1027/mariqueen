import{a as P,r as m,j as e,b as k}from"./app-DoeFD_x_.js";import{A as F}from"./AuthenticatedLayout-C3yt9gg7.js";import{T as i}from"./TextInput-DBGWza4s.js";import{I as r}from"./InputLabel-CgfVJnCL.js";import{I as d}from"./InputError-CmPX5MDB.js";import{J as A}from"./textarea-Cj44b3oi.js";import"./ApplicationLogo-FzfFrs52.js";import"./useFocusRing-DG1TchNR.js";import"./description-TemsyZR1.js";import"./use-sync-refs-nQlUzKFb.js";const J=({mto_sales_orders:j,payment_methods:_})=>{const{data:o,setData:t,post:g,errors:l}=P({sales_order_id:"",order_number:"",payment_method_id:"",status:"",payment_amount:"",grand_total:0,balance:0,remarks:"",type_purpose:"Balance",images:[]}),[p,h]=m.useState(""),[v,u]=m.useState(!1),[n,y]=m.useState(null),[c,x]=m.useState([]),b=j.filter(a=>a.mto_order_number.toLowerCase().includes(p.toLowerCase())),f=a=>{t("order_number",a.mto_order_number),h(a.mto_order_number),u(!1),k.get(`/mto_sales_order/${a.id}`).then(s=>{y(s.data),console.log(s.data),t("grand_total",s.data.grand_amount),t("sales_order_id",s.data.id)}).catch(s=>{console.error("Error fetching order details:",s)})},N=a=>{const s=Array.from(a.target.files);t("images",s),x(s)},w=a=>{const s=c.filter((I,C)=>C!==a);x(s),t("images",s)},S=a=>{a.preventDefault(),console.log(o),g("/mto_sales_payments")};return e.jsx(F,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Create Sales Payment"}),children:e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-4xl rounded-lg bg-white p-8 shadow-md",children:e.jsxs("div",{children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(r,{for:"order_number",value:"Order Number"}),e.jsx(i,{id:"order_number",name:"order_number",value:p,onChange:a=>{h(a.target.value),u(!0)},onFocus:()=>u(!0),className:"w-full rounded border p-2",placeholder:"Search Order Number..."}),e.jsx(d,{message:l.order_number}),v&&b.length>0&&e.jsx("ul",{className:"absolute z-10 max-h-60 w-full overflow-y-auto rounded border bg-white",children:b.map(a=>e.jsx("li",{className:"cursor-pointer px-4 py-2 hover:bg-gray-200",onClick:()=>f(a),children:a.mto_order_number},a.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"payment_method_id",value:"Payment Method"}),e.jsxs("select",{id:"payment_method_id",value:o.payment_method_id,onChange:a=>t("payment_method_id",a.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Select Payment Method"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(d,{message:l.payment_method_id})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"status",value:"Status"}),e.jsxs("select",{id:"status",value:o.status,onChange:a=>t("status",a.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"partial",children:"Partial"})]}),e.jsx(d,{message:l.status})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"type_purpose",value:"Purpose"}),e.jsxs("select",{id:"type_purpose",value:o.type_purpose,onChange:a=>t("type_purpose",a.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Select purpose"}),e.jsx("option",{value:"balance",children:"Balance"}),e.jsx("option",{value:"additional",children:"Additional"})]}),e.jsx(d,{message:l.type_purpose})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"payment_amount",value:"Client Payment Amount"}),e.jsx(i,{id:"payment_amount",type:"number",value:o.payment_amount,onChange:a=>t("payment_amount",a.target.value),className:"w-full"}),e.jsx(d,{message:l.payment_amount})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"grand_total",value:"Grand Total"}),e.jsx(i,{id:"grand_total",type:"number",value:n==null?void 0:n.grand_amount,disabled:!0,className:"w-full bg-gray-100"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"balance",value:"Balance"}),e.jsx(i,{id:"balance",type:"number",value:n==null?void 0:n.balance,disabled:!0,className:"w-full bg-gray-100"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{for:"remarks",value:"Remarks"}),e.jsx(A,{className:"w-full rounded border p-2",value:o.remarks,onChange:a=>t("remarks",a.target.value)})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Upload Payment Images (Multiple Allowed)"}),e.jsx("input",{type:"file",name:"new_images",multiple:!0,onChange:N,className:"border p-2 rounded"}),l.new_images&&e.jsx("div",{className:"text-red-500 mt-2",children:l.new_images}),c.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Selected Files:"}),e.jsx("ul",{className:"list-disc list-inside",children:c.map((a,s)=>e.jsxs("li",{className:"text-gray-700 flex items-center justify-between",children:[a.name,e.jsx("button",{type:"button",onClick:()=>w(s),className:"text-red-500 ml-2",children:"Remove"})]},s))})]})]}),e.jsx("button",{type:"submit",onClick:S,className:"focus:shadow-outline rounded bg-emerald-500 px-4 py-2 font-bold text-white hover:bg-emerald-700 focus:outline-none",children:"Create Sales Payment"})]})})})})};export{J as default};
