import{a as R,r as m,j as e,U as B}from"./app-XbM4MTtE.js";import{A as E}from"./AuthenticatedLayout-w2cwkla7.js";import{I as o}from"./InputLabel-D3hMO2O-.js";import{I as d}from"./InputError-DMquHXnv.js";import{T as x}from"./TextInput-CaUVEw24.js";import{J as Q}from"./textarea-Cdp_I9XG.js";import"./ApplicationLogo-C4haFooD.js";import"./description-DXu3XtFM.js";import"./use-sync-refs-B2J8168g.js";const ee=({products:w,colors:k,heel_heights:S,size_values:F,couriers:f,payment_methods:I,customers:b,packaging_types:z})=>{const{data:a,setData:r,post:$,errors:n}=R({cart:[],product_name:"",color_name:"",size_values:"",heel_heights:"",type_of_heels:"",round:"",length:"",back_strap:"",cost:"",courier_id:"",payment_method_id:"",shipping_cost:0,rush_order_fee:"",payment_amount:0,total_amount:0,grand_total:0,remarks:"",customer_id:0,packaging_type_id:"",shoulder_by:"bragais",images:[]}),[u,y]=m.useState(""),[T,g]=m.useState(!1),[_,C]=m.useState([]),P=()=>u?b.filter(s=>{const l=`${s.first_name} ${s.last_name}`.toLowerCase();return s.first_name.toLowerCase().includes(u.toLowerCase())||s.last_name.toLowerCase().includes(u.toLowerCase())||l.includes(u.toLowerCase())||s.id.toString().includes(u)}):b,D=()=>{const s=Date.now(),l=parseFloat(a.cost)||0,t={id:s,product_name:a.product_name,color_name:a.color_name,size_values:a.size_values,heel_heights:a.heel_heights,type_of_heels:a.type_of_heels,round:a.round,length:a.length,back_strap:a.back_strap,cost:l,quantity:1,subtotal:l},i=a.cart.findIndex(c=>c.product_name===t.product_name&&c.color_name===t.color_name&&c.size_values===t.size_values&&c.heel_heights===t.heel_heights&&c.type_of_heels===t.type_of_heels&&c.round===t.round&&c.length===t.length&&c.back_strap===t.back_strap&&c.cost===t.cost);let p=[...a.cart];if(i!==-1){const c=p[i],N=c.quantity+1;p[i]={...c,quantity:N,subtotal:N*c.cost}}else p.push(t);r("cart",p)},L=s=>{const l=a.cart.map(t=>{if(t.id===s){const i=t.quantity+1;return{...t,quantity:i,subtotal:i*t.cost}}return t});r("cart",l)},q=s=>{let l=a.cart.map(t=>{if(t.id===s&&t.quantity>1){const i=t.quantity-1;return{...t,quantity:i,subtotal:i*t.cost}}return t});l=l.filter(t=>t.quantity>0),r("cart",l)},A=s=>{const l=a.cart.filter(t=>t.id!==s);r("cart",l)},j=a.cart.reduce((s,l)=>s+l.subtotal,0),v=j+parseFloat(a.shipping_cost||0)+parseFloat(a.rush_order_fee||0),h=a.payment_amount-v,O=s=>{s.preventDefault();const l=new FormData;a.images.forEach(t=>{l.append("images[]",t)}),$("/made_to_orders",{data:l,forceFormData:!0}),console.log(a)},H=s=>{const l=Array.from(s.target.files);r("images",l),C(l)},M=s=>{const l=_.filter((t,i)=>i!==s);C(l),r("images",l)};return m.useEffect(()=>{r(s=>({...s,total_amount:j,grand_total:v}))},[a.cart,a.shipping_cost,a.rush_order_fee]),e.jsx(E,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Made To Order - POS"}),children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4",children:[e.jsxs("div",{className:"col-span-2 rounded-md border p-4 shadow-md",children:[e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(o,{for:"product",value:"Products"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.product_name,onChange:s=>r("product_name",s.target.value),children:[e.jsx("option",{value:"",children:"Select Product Name"}),w.map(s=>e.jsx("option",{value:s.product_name,children:s.product_name},s.id)),e.jsx("option",{value:"others",children:"Others"})]}),e.jsx(d,{message:n.product_name})]}),e.jsxs("div",{children:[e.jsx(o,{for:"color",value:"Colors"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.color_name,onChange:s=>r("color_name",s.target.value),children:[e.jsx("option",{value:"",children:"Select Color"}),k.map(s=>e.jsx("option",{value:s.color_name,children:s.color_name},s.id)),e.jsx("option",{value:"others",children:"Others"})]}),e.jsx(d,{message:n.color_name})]}),e.jsxs("div",{children:[e.jsx(o,{for:"size_value",value:"Size Values"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.size_values,onChange:s=>r("size_values",s.target.value),children:[e.jsx("option",{value:"",children:"Select Size"}),F.map(s=>e.jsxs("option",{value:s.size_values,children:[s.size_values," - ",s.size.size_name]},s.id)),e.jsx("option",{value:"others",children:"Others"})]}),e.jsx(d,{message:n.size_values})]}),e.jsxs("div",{children:[e.jsx(o,{for:"heel_heights",value:"Heel Heights"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.heel_heights,onChange:s=>r("heel_heights",s.target.value),children:[e.jsx("option",{value:"",children:"Select Heel Height"}),S.map(s=>e.jsxs("option",{value:s.value,children:[s.value," Inches"]},s.id)),e.jsx("option",{value:"others",children:"Others"})]}),e.jsx(d,{message:n.heel_heights})]}),e.jsxs("div",{children:[e.jsx(o,{for:"type_of_heels",value:"Type of Heels"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.type_of_heels,onChange:s=>r("type_of_heels",s.target.value),children:[e.jsx("option",{value:"",children:"Select Type of Heels"}),e.jsx("option",{value:"b-thick_heel",children:"B-Thick Heel"}),e.jsx("option",{value:"pin_heel",children:"Pin Heel"}),e.jsx("option",{value:"block_heel",children:"Block Heel"}),e.jsx("option",{value:"others",children:"Others"})]}),e.jsx(d,{message:n.type_of_heels})]}),e.jsxs("div",{children:[e.jsx(o,{for:"round",value:"Round (Add CM/IN after value)"}),e.jsx(x,{type:"text",id:"round",name:"round",value:a.round,onChange:s=>r("round",s.target.value),className:"w-full border px-4 py-2"}),e.jsx(d,{message:n.round})]}),e.jsxs("div",{children:[e.jsx(o,{for:"length",value:"Length (Add CM/IN after value)"}),e.jsx(x,{type:"text",id:"length",name:"length",value:a.length,onChange:s=>r("length",s.target.value),className:"w-full border px-4 py-2"}),e.jsx(d,{message:n.length})]}),e.jsxs("div",{children:[e.jsx(o,{for:"back_strap",value:"Back Strap (Add CM/IN after value)"}),e.jsx(x,{type:"text",id:"back_strap",name:"back_strap",value:a.back_strap,onChange:s=>r("back_strap",s.target.value),className:"w-full border px-4 py-2"}),e.jsx(d,{message:n.back_strap})]}),e.jsxs("div",{children:[e.jsx(o,{for:"cost",value:"Cost"}),e.jsx(x,{type:"number",id:"cost",name:"cost",value:a.cost,onChange:s=>r("cost",s.target.value),className:"w-full border px-4 py-2"}),e.jsx(d,{message:n.cost})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"button",className:"w-full rounded-md bg-blue-500 px-4 py-2 font-semibold text-white hover:bg-blue-600",onClick:D,children:"Add to Cart"})})]}),e.jsxs("div",{className:"rounded-md border p-4 shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Cart"}),a.cart.length===0?e.jsx("p",{className:"text-gray-500",children:"No items in cart"}):e.jsx("div",{children:a.cart.map(s=>e.jsxs("div",{className:"flex items-center justify-between border-b py-2",children:[e.jsxs("span",{children:[s.product_name," - ",s.color_name," -",s.size_values&&`Size: ${s.size_values} -`,s.heel_heights&&` ${s.heel_heights} Inches -`,s.type_of_heels&&` Type: ${s.type_of_heels} - `,s.round&&` Round: ${s.round} - `,s.length&&` Length: ${s.length} - `,s.back_strap&&` Back Strap: ${s.back_strap}`]}),e.jsxs("span",{children:["₱",s.cost]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>q(s.id),className:"mx-1 rounded-md bg-gray-300 px-2 py-1 text-gray-700",children:"-"}),e.jsx("span",{className:"mx-1",children:s.quantity}),e.jsx("button",{onClick:()=>L(s.id),className:"mx-1 rounded-md bg-gray-300 px-2 py-1 text-gray-700",children:"+"}),e.jsx("button",{onClick:()=>A(s.id),className:"ml-2 text-red-500",children:"Remove"})]})]},s.id))}),e.jsx(d,{message:n.cart}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-lg font-bold",children:["Total: ₱",j.toFixed(2)]}),e.jsx(B,{href:"/customers/create",className:"mt-4 inline-block rounded bg-blue-500 px-4 py-2 text-white shadow hover:bg-blue-600",children:"New Customer"}),e.jsx(o,{for:"customer",value:"Customer"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search by ID, First or Last Name",className:"w-full rounded-md border p-2",value:u,onChange:s=>{y(s.target.value),g(!0)},onFocus:()=>g(!0)}),T&&e.jsx("ul",{className:"absolute z-10 w-full overflow-y-auto rounded border bg-white max-h-40",children:P().map(s=>e.jsxs("li",{className:"cursor-pointer px-4 py-2 hover:bg-gray-200",onClick:()=>{r("customer_id",s.id),y(`${s.first_name} ${s.last_name} (ID: ${s.id})`),g(!1)},children:[s.first_name," ",s.last_name," (ID: ",s.id,")"]},s.id))})]}),e.jsx(d,{message:n.customer_id}),e.jsx(o,{for:"courier",value:"Couriers"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.courier_id,onChange:s=>{const l=s.target.value;r("courier_id",l);const t=f.find(i=>i.id==l);t&&r("shipping_cost",t.fixed_shipping_cost)},children:[e.jsx("option",{value:"",children:"Select Courier"}),f.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(d,{message:n.courier_id}),a.courier_id&&e.jsxs(e.Fragment,{children:[e.jsx(o,{for:"shipping_cost",value:"Shipping Cost"}),e.jsx("input",{type:"number",placeholder:"Shipping Cost",className:"w-full rounded-md border p-2",value:a.shipping_cost,onChange:s=>r("shipping_cost",s.target.value)}),e.jsx(o,{for:"shoulder_by",value:"Shoulder By"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.shoulder_by,onChange:s=>r("shoulder_by",s.target.value),children:[e.jsx("option",{value:"bragais",children:"Bragais"}),e.jsx("option",{value:"client",children:"Client"})]})]}),e.jsx(d,{message:n.shipping_cost}),e.jsx(o,{for:"packaging_type_id",value:"Packaging Type"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.packaging_type_id,onChange:s=>r("packaging_type_id",s.target.value),children:[e.jsx("option",{value:"",children:"Select Packaging Type"}),z.map(s=>e.jsx("option",{value:s.id,children:s.packaging_name},s.id))]}),e.jsx(d,{message:n.packaging_type_id}),e.jsx(o,{for:"payment_method",value:"Payment Method"}),e.jsxs("select",{className:"w-full rounded-md border p-2",value:a.payment_method_id,onChange:s=>r("payment_method_id",s.target.value),children:[e.jsx("option",{value:"",children:"Select Payment Method"}),I.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(d,{message:n.payment_method_id}),e.jsx(o,{for:"rush_order_fee",value:"Rush Cost"}),e.jsx("input",{type:"number",placeholder:"Rush Order Fee",className:"w-full rounded-md border p-2",value:a.rush_order_fee,onChange:s=>r("rush_order_fee",s.target.value)}),e.jsx(o,{for:"payment_amount",value:"Client Payment"}),e.jsx("input",{type:"number",placeholder:"Enter Payment Amount",className:"w-full rounded-md border p-2",value:a.payment_amount,onChange:s=>r("payment_amount",s.target.value)}),e.jsx(d,{message:n.payment_amount}),e.jsx(o,{for:"remarks",value:"Remarks/Note:"}),e.jsx(Q,{className:"w-full",value:a.remarks,onChange:s=>r("remarks",s.target.value)}),e.jsx(d,{message:n.remarks}),e.jsxs("p",{className:"mt-2 text-lg font-bold",children:["Grand Total: ₱",v.toFixed(2)]}),e.jsx("p",{className:`mt-2 text-lg ${h<0?"text-red-500":"text-green-500"}`,children:h<0?`Balance Due: ₱${Math.abs(h).toFixed(2)}`:`Change: ₱${h.toFixed(2)}`}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"Upload Payment Images (Multiple Allowed)"}),e.jsx("input",{type:"file",name:"new_images",multiple:!0,onChange:H,className:"rounded border p-2"}),n.new_images&&e.jsx("div",{className:"mt-2 text-red-500",children:n.new_images}),_.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Selected Files:"}),e.jsx("ul",{className:"list-inside list-disc",children:_.map((s,l)=>e.jsxs("li",{className:"flex items-center justify-between text-gray-700",children:[s.name,e.jsx("button",{type:"button",onClick:()=>M(l),className:"ml-2 text-red-500",children:"Remove"})]},l))})]})]}),e.jsx("button",{onClick:O,className:`${a.cart.length===0||a.courier_id===""||a.payment_method_id===""?"bg-green-700":"bg-green-500"} mt-2 w-full rounded-md px-4 py-2 text-white`,disabled:a.cart.length===0||a.courier_id===""||a.payment_method_id==="",children:"Process Sale"})]})]})]})})};export{ee as default};
