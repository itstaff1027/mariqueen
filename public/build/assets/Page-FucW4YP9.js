import{r as n,a as I,j as e,h as D}from"./app-DzVPnBm_.js";import{A as Q}from"./AuthenticatedLayout-CM951Vbx.js";import{T as v}from"./TextInput-BMqz3Mf8.js";import{I as u}from"./InputLabel-CVOs2is0.js";import{I as c}from"./InputError-W5ybVOTN.js";import{J as E}from"./textarea-C9AA6iOp.js";import"./ApplicationLogo-1LC3dhoW.js";import"./useFocusRing-CbgUoASV.js";import"./description-DvabQjNZ.js";import"./use-sync-refs-mp_AuGG8.js";const J=({sales_order:t,sales_orders:m,warehouses:w})=>{var y;const[a,h]=n.useState(((y=t==null?void 0:t.items)==null?void 0:y.map(r=>({...r,returnQuantity:r.quantity})))||[]),{data:o,setData:d,post:N,errors:i}=I({sales_order_id:(t==null?void 0:t.id)||"",sales_order_number:(t==null?void 0:t.order_number)||"",items:[],return_date:new Date().toISOString().split("T")[0],warehouse_id:"",remarks:""}),[g,f]=n.useState(""),[S,x]=n.useState(!1),b=m==null?void 0:m.filter(r=>r.order_number.toLowerCase().includes(g.toLowerCase())),_=r=>{x(!1),D.visit("/sales_order_returns/create",{method:"get",data:{order_number:r.order_number},preserveState:!1,preserveScroll:!0})},k=r=>{h(s=>s.filter(p=>p.id!==r))},C=(r,s)=>{h(p=>p.map(l=>{if(l.id===r){const j=l.quantity,R=s>j?j:s;return{...l,returnQuantity:R}}return l}))},O=()=>{console.log(o),N("/sales_order_returns")};return n.useEffect(()=>{d("items",a)},[a]),n.useEffect(()=>{f((t==null?void 0:t.order_number)||"")},[t]),e.jsx(Q,{header:e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Create Order Return"}),children:e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-lg bg-white p-8 shadow-lg",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx(u,{htmlFor:"order_number",value:"Order Number"}),e.jsx(v,{id:"order_number",name:"order_number",value:g,onChange:r=>{f(r.target.value),x(!0)},onFocus:()=>x(!0),placeholder:"Search Order Number...",className:"w-full rounded-md border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(c,{message:i.order_number}),S&&b.length>0&&e.jsx("ul",{className:"absolute left-0 right-0 z-10 mt-1 max-h-60 overflow-y-auto rounded-md border border-gray-200 bg-white shadow-lg",children:b.map(r=>e.jsx("li",{onClick:()=>_(r),className:"cursor-pointer px-4 py-2 hover:bg-blue-50",children:r.order_number},r.id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx(u,{htmlFor:"return_date",value:"Return Date (YYYY-MM-DD)"}),e.jsx(v,{id:"return_date",name:"return_date",value:o.return_date,onChange:r=>{d("return_date",r.target.value)},placeholder:"Return Date",className:"w-full rounded-md border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(c,{message:i.return_date})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx(u,{htmlFor:"warehouse_id",value:"Select Warehouse"}),e.jsxs("select",{className:"w-full rounded-md border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",id:"warehouse_id",name:"warehouse_id",value:o.warehouse_id,onChange:r=>{d("warehouse_id",r.target.value)},children:[e.jsx("option",{value:"",children:"Select Warehouse"}),w.map(r=>e.jsx("option",{value:r.id,children:r.name}))]}),e.jsx(c,{message:i.warehouse_id})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Return Qty"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[a==null?void 0:a.map(r=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-700",children:r.id}),e.jsxs("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-700",children:[r.product_variant.product.product_name," ","–"," ",r.product_variant.colors.color_name," ","– Size:"," ",parseInt(r.product_variant.size_values.size_values)," ","– Heel:"," ",r.product_variant.heel_heights.value,'"']}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:e.jsx("input",{type:"number",min:"0",max:r.quantity,value:r.returnQuantity,onChange:s=>C(r.id,parseInt(s.target.value)),className:"w-20 rounded-md border border-gray-300 p-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>k(r.id),className:"inline-flex items-center rounded-md bg-red-500 px-3 py-1 text-xs font-semibold text-white hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400",children:"Remove"})})]},r.id)),a.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No items to display."})})]})]})}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"remarks",value:"Remarks"}),e.jsx(E,{id:"remarks",name:"remarks",value:o.remarks,onChange:r=>{d("remarks",r.target.value)},placeholder:"Remarks/Note/Reasons...",className:"w-full rounded-md border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(c,{message:i.remarks})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx("button",{type:"submit",className:"inline-flex items-center rounded-md bg-emerald-500 px-6 py-3 text-base font-semibold text-white hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-400",onClick:O,children:"Create Order Return"})})]})})})})};export{J as default};
