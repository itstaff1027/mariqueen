import{r as c,j as e,U as D,h as $}from"./app-D-5IxQ04.js";import{A as V}from"./AuthenticatedLayout-DDjMNUEK.js";import"./ApplicationLogo-lhzCgZBe.js";const q=({onClose:i,order:t})=>{const[m,b]=c.useState(""),g=c.useRef(null);c.useEffect(()=>{fetch("/storage/assets/jojoBragaisWW.png").then(r=>{if(!r.ok)throw new Error("Network response was not ok");return r.blob()}).then(r=>{const n=new FileReader;n.onloadend=()=>{b(n.result)},n.readAsDataURL(r)}).catch(r=>console.error("Error loading image:",r))},[]);const j=()=>{const{jsPDF:r}=window.jspdf,n=new r({orientation:"portrait",unit:"pt",format:"a4"}),h=10,v=n.internal.pageSize.getWidth(),y=g.current,_=y.offsetWidth,w=(v-h*2)/_;n.html(y,{x:h,y:h,html2canvas:{useCORS:!0,scale:w},callback:f=>{f.save(`SalesOrder_${t.order_number}.pdf`)}})};return e.jsx("div",{className:"w-full",style:{position:"fixed",inset:0,alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0,0,0,0.5)",zIndex:50,overflowY:"auto"},children:e.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",margin:"20px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{onClick:i,style:{color:"red",fontSize:"14px",border:"none",background:"none"},children:"Close"})}),e.jsx("div",{ref:g,style:{padding:"20px",color:"#000",fontSize:"12pt",backgroundColor:"#fff"},children:e.jsxs("div",{className:"container mx-auto p-6",children:[m&&e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:m,alt:"Logo",style:{maxWidth:"150px",marginBottom:"10px"}})}),e.jsxs("div",{className:"flex w-full flex-col items-center justify-center p-10",children:[e.jsxs("div",{className:"grid w-full grid-cols-2 border-b-2",children:[e.jsx("h1",{className:"w-full text-left text-3xl font-bold"}),e.jsxs("h1",{className:"w-full text-right text-3xl font-bold",children:["Status: ",t.status.toUpperCase()]})]}),e.jsxs("div",{className:"grid grid-cols-2 w-full",children:[e.jsxs("h1",{className:"text-2xl font-bold w-full text-left",children:["Courier: ",e.jsx("u",{children:t.courier.name.toUpperCase()})]}),e.jsxs("h1",{className:"text-2xl font-bold w-full text-right",children:["Packaging Type:"," ",e.jsx("u",{children:t.packaging_type.packaging_name.toUpperCase()})]})]}),e.jsx("div",{className:"grid grid-cols-2 w-full",children:e.jsxs("h1",{className:"text-2xl font-bold w-full text-left",children:["Shoulder By: ",e.jsx("u",{children:t.shoulder_by.toUpperCase()})]})}),e.jsxs("div",{className:"my-4 w-full",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Order Items"}),e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"SKU"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Total Price"})]})}),e.jsx("tbody",{children:t.items&&t.items.length>0?t.items.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:r.product_variant.sku}),e.jsx("td",{className:"border px-4 py-2 text-right",children:r.quantity}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",parseFloat(r.unit_price).toFixed(2)]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",parseFloat(r.total_price).toFixed(2)]})]},r.id)):e.jsx("tr",{children:e.jsx("td",{className:"border px-4 py-2 text-center",colSpan:"5",children:"No items found"})})})]})]}),e.jsxs("div",{className:"flex w-full flex-col items-end justify-end border-t pt-4",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Order Summary"}),e.jsxs("p",{className:"text-gray-700",children:["Subtotal: P ",parseFloat(t.total_amount).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["VATables: P",parseFloat(t.total_amount/1.12).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["VAT: P",parseFloat(t.total_amount/1.12*.12).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["Shipping Cost: P ",parseFloat(t.shipping_cost).toFixed(2)]}),e.jsxs("p",{className:"text-gray-700",children:["Rush Order Fee: P",parseFloat(t.rush_order_fee).toFixed(2)]}),e.jsxs("p",{className:"font-bold text-2xl text-gray-700",children:["Grand Total: P ",parseFloat(t.grand_amount).toFixed(2)]})]}),e.jsx("div",{className:"w-full mb-4",children:e.jsxs("p",{className:"text-l font-bold w-full",children:["Packaging Type Description:"," ",e.jsx("u",{children:t.packaging_type.description})]})}),e.jsxs("div",{className:"mb-4 w-full",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Payment Information"}),e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"Payment Method"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Amount Paid"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Change Due"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Excess"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Balance"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Date"})]})}),e.jsx("tbody",{children:t.payments&&t.payments.length>0?t.payments.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"border px-4 py-2",children:r.payment_method.name}),e.jsxs("td",{className:"border px-4 py-2",children:["P ",r.amount_paid]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",r.change_due]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",r.excess_amount]}),e.jsxs("td",{className:"border px-4 py-2 text-right",children:["P ",r.remaining_balance]}),e.jsx("td",{className:"border px-4 py-2 text-right"})]},r.id)):e.jsx("tr",{children:e.jsx("td",{className:"border px-4 py-2 text-center",colSpan:"5",children:"No items found"})})})]})]}),e.jsxs("div",{className:"w-full p-4",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Customer Information"}),t.customers?e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-700",children:[t.customers.first_name," ",t.customers.last_name]}),e.jsxs("p",{className:"text-gray-700",children:["Email: ",t.customers.email]}),e.jsxs("p",{className:"text-gray-700",children:["Phone: ",t.customers.phone]}),e.jsxs("p",{className:"text-gray-700",children:["Address: ",t.customers.address]}),t.customers.receiver_name&&e.jsxs("p",{className:"text-gray-700",children:["Receiver: ",t.customers.receiver_name]})]}):e.jsx("p",{className:"text-gray-700",children:"No customer information available."})]}),e.jsxs("div",{className:"w-full border-t pt-4",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Remarks/Note:"}),e.jsx("div",{className:"h-40 w-full rounded-xl border p-4",children:t.remarks})]})]})]})}),e.jsx("div",{style:{marginTop:"16px",textAlign:"center"},children:e.jsx("button",{onClick:j,style:{backgroundColor:"#000",color:"#fff",padding:"10px 20px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"14px"},children:"Download PDF"})})]})})},Y=({sales_orders:i})=>{var f;const[t,m]=c.useState(null),[b,g]=c.useState(""),[j,r]=c.useState(""),[n,h]=c.useState(""),v=()=>{$.visit("/point_of_sales",{method:"get",data:{search:b,fromDate:j,toDate:n},preserveState:!0,preserveScroll:!0})},y=s=>{m(s)},_=()=>{m(null)};c.useEffect(()=>{console.log(i)},[]);const w=()=>{const s=["Order Number","Client Name","Agent Name","Sold From","Tracking Number","Courier","Shoulder By","Packaging Type","Shipping Cost","Rush Cost","Total Cost","Client Payment","Status","Created At","Updated At","Payment ID","Payment Amount","Excess Amount","Remaining Balance","Payment Status","Payment Method","Payment Created At","Item ID","Quantity","Unit Price","Total Price","Discount Amount","Product SKU","Product Name","Color","Size","Heel Height"];let o=[s];const S=15;let N=[],k=1;i.data.forEach(a=>{var R,A,E,O,L,U,I,B,M,z,W,X;const P=[a.order_number,a.customers.first_name+" "+a.customers.last_name,a.user.name,a.warehouse.name,a.tracking_number,((R=a.courier)==null?void 0:R.name)||"",a.shoulder_by,((A=a.packaging_type)==null?void 0:A.packaging_name)||"",a.shipping_cost,a.rush_order_fee,a.total_amount,a.grand_amount,a.status,a.created_at,a.updated_at],p=a.payments?a.payments.length:0,F=a.items?a.items.length:0,d=Math.max(1,p,F);for(let x=0;x<d;x++){const u=[...P];if(a.payments&&a.payments[x]){let l=a.payments[x];u.push(l.id,l.amount_paid,l.excess_amount,l.remaining_balance,l.status,((E=l.payment_method)==null?void 0:E.name)||"",l.created_at)}else u.push("","","","","","","");if(a.items&&a.items[x]){let l=a.items[x];u.push(l.id,l.quantity,l.unit_price,l.total_price,l.discount_amount,((O=l.product_variant)==null?void 0:O.sku)||"",((U=(L=l.product_variant)==null?void 0:L.product)==null?void 0:U.product_name)||"",((B=(I=l.product_variant)==null?void 0:I.colors)==null?void 0:B.color_name)||"",((z=(M=l.product_variant)==null?void 0:M.size_values)==null?void 0:z.size_values)||"",((X=(W=l.product_variant)==null?void 0:W.heel_heights)==null?void 0:X.value)||"")}else u.push("","","","","","","","","","");if(d>1)for(let l=0;l<S;l++)N.push({s:{r:k,c:l},e:{r:k+d-1,c:l}});k+=d,o.push(u)}});const C=XLSX.utils.aoa_to_sheet(o),H=s.map((a,P)=>{let p=a?a.toString().length:10;return o.forEach(F=>{const d=F[P];d&&(p=Math.max(p,d.toString().length))}),{wch:p+2}});C["!cols"]=H,C["!merges"]=N;const T=XLSX.utils.book_new();XLSX.utils.book_append_sheet(T,C,"Sales Transactions"),XLSX.writeFile(T,`Sales_Orders_${new Date().toISOString().split("T")[0]}.xlsx`)};return e.jsxs(V,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Sales Orders"}),children:[e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-md rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Sales Order"}),e.jsx(D,{href:"/point_of_sales/create",className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Create Order"}),e.jsx("button",{onClick:w,children:"Export"})]}),e.jsxs("div",{className:"col-span-3 mb-4 grid grid-cols-1 gap-3 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"From Date:"}),e.jsx("input",{type:"date",value:j,onChange:s=>r(s.target.value),className:"border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"To Date:"}),e.jsx("input",{type:"date",value:n,onChange:s=>h(s.target.value),className:"border rounded p-2"})]}),e.jsx("button",{onClick:v,className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Filter"})]}),e.jsx("input",{type:"text",placeholder:"Search for Order Number, Customer Name, Tracking #",className:"w-full rounded-md border p-2 mb-2",value:b,onChange:s=>g(s.target.value)}),e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"#"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Order #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Client Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Tracking #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Status"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Payment"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Balance"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:(f=i.data)==null?void 0:f.map((s,o)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:o+1}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.order_number}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[s.customers.first_name," ",s.customers.last_name]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.tracking_number?s.tracking_number:"No Tracking # added yet."}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.status}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.grand_amount}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.payments.reduce((S,N)=>S+parseFloat(N.amount_paid,2),0).toFixed(2)}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.balance}),e.jsxs("td",{className:"border border-gray-300 px-6 py-3 space-x-2",children:[e.jsx("button",{onClick:()=>y(s),className:"p-2 rounded-xl text-red-500 hover:underline",children:"Print"}),e.jsx(D,{href:`/point_of_sales/${s.id}/edit`,className:"text-blue-500 hover:underline",children:"Edit"}),e.jsx(D,{href:`/point_of_sales/${s.id}`,className:"text-emerald-500 hover:underline",children:"View"})]})]},s.id))})]}),i.links&&e.jsx("div",{className:"mt-4 flex justify-center",children:i.links.map((s,o)=>e.jsx("button",{onClick:()=>{s.url&&$.visit(s.url,{preserveState:!0,preserveScroll:!0})},className:`mx-1 px-3 py-1 border rounded ${s.active?"bg-blue-500 text-white":"bg-white text-blue-500"}`,dangerouslySetInnerHTML:{__html:s.label}},o))})]})})})})}),t&&e.jsx(q,{order:t,onClose:_})]})};export{Y as default};
