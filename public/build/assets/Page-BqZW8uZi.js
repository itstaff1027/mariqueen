import{a as k,r as d,j as e,h}from"./app-f0nE6TeN.js";import{A as C}from"./AuthenticatedLayout-DVY7Bfvv.js";import{T as c}from"./TextInput-than_Bjx.js";import{I as i}from"./InputLabel-SP7XutBF.js";import{I as o}from"./InputError-uIHyxXvA.js";import"./ApplicationLogo-XGu9A9TJ.js";const M=({sales_payment:s,payment_methods:_})=>{const{data:t,setData:n,put:j,errors:l}=k({sales_payment_id:s.id||"",order_number:s.sales_order.order_number||"",payment_method_id:s.payment_method_id||"",status:s.status||"",client_payment_amount:s.amount_paid||"",grand_total:s.sales_order.grand_amount||"",remarks:s.remarks||"",payment_images:Array.isArray(s.payment_images)?s.payment_images:[]}),v=a=>{a.preventDefault(),j(`/sales_payments/${s.id}`)};d.useEffect(()=>{console.log(s),console.log(t.payment_images)},[]);const[u,S]=d.useState(t.payment_images),[x,p]=d.useState(null),[m,g]=d.useState([]);d.useEffect(()=>{console.log("Sales Payment:",s.id),console.log("Local Images:",u)},[s,u]);const b=a=>{const r=Array.from(a.target.files);g(r)},y=a=>{const r=m.filter((I,w)=>w!==a);g(r)},f=a=>{h.post("/sales_payment/upload/images",{data:{sales_payment_id:s.id,new_images:m}},{preserveState:!0})},N=a=>{h.post("/sales_payment/destroy/image",{payment_image_id:a,sales_payment_id:s.id},{preserveState:!0})};return e.jsx(C,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Edit sales_payments"}),children:e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 text-gray-900",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{for:"order_number",value:"sales_payments - Order Number"}),e.jsx(c,{id:"order_number",name:"order_number",value:t.order_number,onChange:a=>n("order_number",a.target.value),className:"w-full",disabled:!0}),e.jsx(o,{message:l.order_number})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{for:"paymenet_method_id",value:"sales_payments - Payment Method"}),e.jsxs("select",{id:"payment_method_id",value:t.payment_method_id,onChange:a=>n("payment_method_id",a.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Select Payment Method"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(o,{message:l.payment_method_id})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{for:"status",value:"sales_payment - Status"}),e.jsxs("select",{id:"status",value:t.status,onChange:a=>n("status",a.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"partial",children:"Partial"})]}),e.jsx(o,{message:l.status})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{for:"client_payment_amount",value:"sales_payments - client_payment_amount"}),e.jsx(c,{id:"client_payment_amount",name:"client_payment_amount",value:t.client_payment_amount,onChange:a=>n("client_payment_amount",a.target.value),className:"w-full",disabled:!0}),e.jsx(o,{message:l.client_payment_amount})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{for:"grand_total",value:"sales_payments - grand_total"}),e.jsx(c,{id:"grand_total",name:"grand_total",value:t.grand_total,onChange:a=>n("grand_total",a.target.value),className:"w-full",disabled:!0}),e.jsx(o,{message:l.grand_total})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{for:"remarks",value:"sales_payments - Remarks"}),e.jsx(c,{id:"remarks",name:"remarks",type:"text",value:t.remarks,onChange:a=>n("remarks",a.target.value),className:"w-full"}),e.jsx(o,{message:l.remarks})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.payment_images.map((a,r)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/storage/${a.image}`,alt:"Payment",className:"w-full h-24 object-cover rounded cursor-pointer",onClick:()=>p(a)}),e.jsx("button",{type:"button",onClick:()=>{window.confirm("Are you sure you want to remove this image?")&&N(a.id)},className:"absolute top-1 right-1 bg-red-500 text-white text-xs px-1 py-0.5 rounded",children:"Remove"})]},r))}),x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/storage/${x.image}`,alt:"Preview",className:"max-h-full max-w-full rounded"}),e.jsx("button",{type:"button",onClick:()=>p(null),className:"absolute top-2 right-2 bg-white text-black px-2 py-1 rounded",children:"Close"})]})})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Upload Payment Images (Multiple Allowed)"}),e.jsx("input",{type:"file",name:"new_images",multiple:!0,onChange:b,className:"border p-2 rounded"}),l.new_images&&e.jsx("div",{className:"text-red-500 mt-2",children:l.new_images}),m.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Selected Files:"}),e.jsx("ul",{className:"list-disc list-inside",children:m.map((a,r)=>e.jsxs("li",{className:"text-gray-700 flex items-center justify-between",children:[a.name,e.jsx("button",{type:"button",onClick:()=>y(r),className:"text-red-500 ml-2",children:"Remove"})]},r))})]}),e.jsx("button",{onClick:f,type:"submit",className:"focus:shadow-outline rounded bg-emerald-500 px-4 py-2 font-bold text-white hover:bg-emerald-700 focus:outline-none",children:"Upload New Images"})]}),e.jsx("button",{onClick:v,type:"submit",className:"focus:shadow-outline rounded bg-emerald-500 px-4 py-2 font-bold text-white hover:bg-emerald-700 focus:outline-none",children:"Edit sales_payments"})]})})})})})})};export{M as default};
