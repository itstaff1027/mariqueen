import{r as c,V as Q,j as e,U as g,h as O}from"./app-C3V3ZFep.js";import{A as W}from"./AuthenticatedLayout-DP8v5RI5.js";import{M as G}from"./MTOSquare-CDEpdNb7.js";import"./ApplicationLogo-BcrHQoSU.js";const ee=({made_to_orders:i})=>{var w;const[y,j]=c.useState(null),[N,F]=c.useState(""),[f,X]=c.useState(""),[_,I]=c.useState(""),{auth:B}=Q().props,H=B.user.roles[0],U=()=>{O.visit("/made_to_orders",{method:"get",data:{search:N,fromDate:f,toDate:_},preserveState:!0,preserveScroll:!0})},$=t=>{j(t)},q=()=>{j(null)};c.useEffect(()=>{},[]);const z=()=>{const t=["Order Number","Client Name","Agent Name","Sold From","Tracking Number","Courier","Shoulder By","Packaging Type","Shipping Cost","Rush Cost","Total Cost","Client Payment","Status","Created At","Updated At","Payment ID","Payment Amount","Excess Amount","Remaining Balance","Payment Status","Payment Method","Payment Created At","Item ID","Quantity","Unit Price","Total Price","Discount Amount","Product Name","Color","Size","Heel Height","Round","Length","Back Strap","Type of Heel"];let r=[t];const u=15;let m=[],h=1;i.data.forEach(a=>{var S,k,C,T,P,D,M,A,L,R,E;const x=[a.mto_order_number,a.customers.first_name+" "+a.customers.last_name,a.user.name,H.name,a.tracking_number,((S=a.courier)==null?void 0:S.name)||"",a.shoulder_by,((k=a.packaging_type)==null?void 0:k.packaging_name)||"",a.shipping_cost,a.rush_order_fee,a.total_amount,a.grand_amount,a.status,a.created_at,a.updated_at],o=a.payments?a.payments.length:0,b=a.items?a.items.length:0,l=Math.max(1,o,b);for(let n=0;n<l;n++){const d=[...x];if(a.payments&&a.payments[n]){let s=a.payments[n];d.push(s.id,s.amount_paid,s.excess_amount,s.remaining_balance,s.status,((C=s.payment_method)==null?void 0:C.name)||"",s.created_at)}else d.push("","","","","","","");if(a.items&&a.items[n]){let s=a.items[n];d.push(s.id,s.quantity,s.unit_price,s.total_price,s.discount_amount,((T=s.made_to_order_product)==null?void 0:T.product_name)||"",((P=s.made_to_order_product)==null?void 0:P.color)||"",((D=s.made_to_order_product)==null?void 0:D.size)||"",((M=s.made_to_order_product)==null?void 0:M.heel_height)||"",((A=s.made_to_order_product)==null?void 0:A.round)||"",((L=s.made_to_order_product)==null?void 0:L.length)||"",((R=s.made_to_order_product)==null?void 0:R.back_strap)||"",((E=s.made_to_order_product)==null?void 0:E.type_of_heel)||"")}else d.push("","","","","","","","","","");if(l>1)for(let s=0;s<u;s++)m.push({s:{r:h,c:s},e:{r:h+l-1,c:s}});h+=l,r.push(d)}});const p=XLSX.utils.aoa_to_sheet(r),V=t.map((a,x)=>{let o=a?a.toString().length:10;return r.forEach(b=>{const l=b[x];l&&(o=Math.max(o,l.toString().length))}),{wch:o+2}});p["!cols"]=V,p["!merges"]=m;const v=XLSX.utils.book_new();XLSX.utils.book_append_sheet(v,p,"Sales Transactions"),XLSX.writeFile(v,`made_to_orders_${new Date().toISOString().split("T")[0]}.xlsx`)};return e.jsxs(W,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Made to Order"}),children:[e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-md rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md space-y-6 w-full mb-2",children:[e.jsxs("div",{className:"flex flex-col w-full justify-between md:flex-row md:justify-betweem md:items-center gap-4",children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"MTO"}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end w-full",children:[e.jsx(g,{href:"/made_to_orders/create",className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Create Order"}),e.jsx("button",{onClick:z,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition",children:"Export"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"From Date:"}),e.jsx("input",{type:"date",value:f,onChange:t=>X(t.target.value),className:"border w-full rounded p-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"To Date:"}),e.jsx("input",{type:"date",value:_,onChange:t=>I(t.target.value),className:"border w-full rounded p-2"})]}),e.jsx("button",{onClick:U,className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Filter"})]}),e.jsx("div",{className:"w-full relative m-0",children:e.jsx("input",{type:"text",placeholder:"Search for Order Number, Customer Name, Tracking #",className:"w-full absolute -translate-y-1/2 text-gray-400",value:N,onChange:t=>F(t.target.value)})})]}),e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"#"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Order #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Client Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Tracking #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Status"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Payment"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Balance"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:(w=i.data)==null?void 0:w.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.mto_order_number}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[t.customers.first_name," ",t.customers.last_name]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.tracking_number?t.tracking_number:"No Tracking # added yet."}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.status}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.grand_amount}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.payments.reduce((u,m)=>u+parseFloat(m.amount_paid,2),0).toFixed(2)}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.balance}),e.jsxs("td",{className:"border border-gray-300 px-6 py-3 space-x-2",children:[e.jsx("button",{onClick:()=>$(t),className:"p-2 rounded-xl text-red-500 hover:underline",children:"Print"}),e.jsx(g,{href:`/made_to_orders/${t.id}/edit`,className:"text-blue-500 hover:underline",children:"Edit"}),e.jsx(g,{href:`/made_to_orders/${t.id}`,className:"text-emerald-500 hover:underline",children:"View"})]})]},t.id))})]}),i.links&&e.jsx("div",{className:"mt-4 flex justify-center",children:i.links.map((t,r)=>e.jsx("button",{onClick:()=>{t.url&&O.visit(t.url,{preserveState:!0,preserveScroll:!0})},className:`mx-1 px-3 py-1 border rounded ${t.active?"bg-blue-500 text-white":"bg-white text-blue-500"}`,dangerouslySetInnerHTML:{__html:t.label}},r))})]})})})})}),y&&e.jsx(G,{order:y,onClose:q})]})};export{ee as default};
