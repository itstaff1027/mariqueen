import{r as l,j as e,U as y,h as j}from"./app-QVnGVJj3.js";import{A as D}from"./AuthenticatedLayout-MkJGPHYv.js";import{M as O}from"./MTOSquare-DFQkkcJP.js";import"./ApplicationLogo-CAYc3vXU.js";const P=({made_to_orders:t})=>{var p;const[i,x]=l.useState(null),[m,N]=l.useState(""),[h,f]=l.useState(""),[u,w]=l.useState(""),v=()=>{j.visit("/logistics_mto_orders",{method:"get",data:{search:m,fromDate:h,toDate:u},preserveState:!0,preserveScroll:!0})},S=s=>{x(s)},k=()=>{x(null)};l.useEffect(()=>{console.log(t)},[]);const C=()=>{const s=["NO. #","Sales Agent","Order #","Customer Soc_Med","Customer Full Name","Tracking #","No # of Box","Remarks"],a=t.data.map((r,c)=>[c+1,r.user.name,r.order_number,r.customers.social_media_account,r.customers.first_name+" "+r.customers.last_name,r.tracking_number,"",""]),d=[s,...a],o=XLSX.utils.aoa_to_sheet(d),T=s.map((r,c)=>{let n=r?r.toString().length:10;return d.forEach(M=>{const g=M[c];g&&(n=Math.max(n,g.toString().length))}),{wch:n+2}});o["!cols"]=T;const b=XLSX.utils.book_new();XLSX.utils.book_append_sheet(b,o,"Shipment Transactions"),XLSX.writeFile(b,`Shipment_Transactions_${new Date().toISOString().split("T")[0]}.xlsx`)};return e.jsxs(D,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Made to Order"}),children:[e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-md rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md space-y-6 w-full mb-2",children:[e.jsxs("div",{className:"flex flex-col w-full justify-between md:flex-row md:justify-betweem md:items-center gap-4",children:[e.jsx("h1",{className:"text-3xl w-full font-semibold",children:"MTO Order"}),e.jsx("div",{className:"flex flex-wrap gap-3 justify-end w-full",children:e.jsx("button",{onClick:C,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition",children:"Export"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"From Date:"}),e.jsx("input",{type:"date",value:h,onChange:s=>f(s.target.value),className:"border w-full rounded p-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"To Date:"}),e.jsx("input",{type:"date",value:u,onChange:s=>w(s.target.value),className:"border w-full rounded p-2"})]}),e.jsx("button",{onClick:v,className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600",children:"Filter"})]}),e.jsx("div",{className:"w-full relative m-0",children:e.jsx("input",{type:"text",placeholder:"Search for Order Number, Customer Name, or Status",className:"w-full absolute -translate-y-1/2 text-gray-400",value:m,onChange:s=>N(s.target.value)})})]}),e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"#"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Order #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Client Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Tracking #"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Status"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Payment"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Balance"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:(p=t.data)==null?void 0:p.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:a+1}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.mto_order_number}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[s.customers.first_name," ",s.customers.last_name]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.tracking_number?s.tracking_number:"No Tracking # added yet."}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.status}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.grand_amount}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.payments.reduce((d,o)=>d+parseFloat(o.amount_paid,2),0).toFixed(2)}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.balance}),e.jsxs("td",{className:"border border-gray-300 px-6 py-3 space-x-2",children:[e.jsx("button",{onClick:()=>S(s),className:"p-2 rounded-xl text-red-500 hover:underline",children:"Print"}),e.jsx(y,{href:`/logistics_mto_orders/${s.id}/edit`,className:"text-blue-500 hover:underline",children:"Edit"}),e.jsx(y,{href:`/logistics_mto_orders/${s.id}`,className:"text-emerald-500 hover:underline",children:"View"})]})]},s.id))})]}),t.links&&e.jsx("div",{className:"mt-4 flex justify-center",children:t.links.map((s,a)=>e.jsx("button",{onClick:()=>{s.url&&j.visit(s.url,{preserveState:!0,preserveScroll:!0})},className:`mx-1 px-3 py-1 border rounded ${s.active?"bg-blue-500 text-white":"bg-white text-blue-500"}`,dangerouslySetInnerHTML:{__html:s.label}},a))})]})})})})}),i&&e.jsx(O,{order:i,onClose:k})]})};export{P as default};
